!function(n,o){"use strict";PushWidgets.WFCheckboxDropdowns=new Class({Implements:[Events,Options],delegationRoot:null,options:{singular:"Item",plural:"Items",verb:"Selected"},bound:{},initialize:function(t,e){this.setOptions(e),this.delegationRoot=$(t)||o.body,this.delegationRoot.addEvent("click:relay([data-checkboxdropdown-trigger])",this.show.bind(this)),PushWidgets.hasTouch&&this.delegationRoot.addEvent("touchend:relay([data-checkboxdropdown-trigger])",this.show.bind(this)),this.bound.hide=this.hide.bind(this),this.delegationRoot.getElements("[data-checkboxdropdown-trigger]").each(function(t){t.partner=$(t.getAttribute("data-checkboxdropdown-trigger"))||t.getElement(t.getAttribute("data-checkboxdropdown-trigger")),(t.partner.partner=t).original_caption=t.get("text"),t.checkboxes=t.partner.getElements('input[type="checkbox"]'),this.updateCaption(t),t.partner.addEvent('click:relay(input[type="checkbox"])',function(){this.updateCaption(t)}.bind(this))}.bind(this))},updateCaption:function(t){var e=t.partner.getElements(":checked").length;t.set("text",0<e?e+" "+(1==e?this.options.singular:this.options.plural)+" "+this.options.verb:t.original_caption)},show:function(t,e){var o=e.partner;o.hasClass("dropdown-open")?this.hide(t):(this.hide(t),o.addClass("dropdown-open"),e.addClass("active"),this.positionElement(e,o),this.fireEvent("show",[t,e]),"touchend"==t.type&&t.preventDefault(),this.bound.resize=function(){this.delegationRoot.getElements("[data-checkboxdropdown-trigger].active").each(function(t){this.positionElement(t,t.partner)}.bind(this))}.bind(this),n.addEvent("resize",this.bound.resize),n.addEvent("scroll",this.bound.resize),this.delegationRoot.addEvent("click",this.bound.hide),PushWidgets.hasTouch&&this.delegationRoot.addEvent("touchend",this.bound.hide))},hide:function(t){this.fireEvent("hide",t);t=$(t.target);(t.hasAttribute("data-cancel")||!t.hasAttribute("data-checkboxdropdown-content")&&null===t.getParent(".dropdown-open[data-checkboxdropdown-content]"))&&($$("[data-checkboxdropdown-trigger]").each(function(t){t.partner.removeClass("dropdown-open"),t.removeClass("active")}),this.delegationRoot.removeEvent("click",this.bound.hide),PushWidgets.hasTouch&&this.delegationRoot.removeEvent("touchend",this.bound.hide),n.removeEvent("resize",this.bound.resize),n.removeEvent("scroll",this.bound.resize))},positionElement:function(t,e){var o,i=(t.getBoundingClientRect().y||t.getBoundingClientRect().top)<n.getHeight()/1.75?(o="top"+(t.getAttribute("data-checkboxdropdown-align")||e.getAttribute("data-checkboxdropdown-align")||"left"),"bottom"+(t.getAttribute("data-checkboxdropdown-align")||e.getAttribute("data-checkboxdropdown-edge")||"left")):(o="bottom"+(t.getAttribute("data-checkboxdropdown-align")||e.getAttribute("data-checkboxdropdown-align")||"left"),"top"+(t.getAttribute("data-checkboxdropdown-align")||e.getAttribute("data-checkboxdropdown-align")||"left"));e.position({relativeTo:t,position:i,edge:o}),e.setStyle("min-width",t.getWidth())}}),PushWidgets.WFCheckboxDropdowns.attach=function(t){PushWidgets.WFCheckboxDropdowns.attached||new PushWidgets.WFCheckboxDropdowns(t||o.body),PushWidgets.WFCheckboxDropdowns.attached=!0}}(window,document);